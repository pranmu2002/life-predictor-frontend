<!DOCTYPE html>
<html>
<head>
  <title>Life Predictor - Login</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    input { margin: 5px; padding: 5px; width: 200px; }
    button { margin: 5px; padding: 8px; }
    .section { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; }
  </style>
</head>
<body>
  <h1>Life Predictor</h1>

  <!-- Register -->
  <div class="section">
    <h2>Register</h2>
    <input id="r_name" placeholder="Name"><br>
    <input id="r_email" placeholder="Email"><br>
    <input id="r_password" type="password" placeholder="Password"><br>
    <button onclick="register()">Register</button>
  </div>

  <!-- User Login -->
  <div class="section">
    <h2>User Login</h2>
    <input id="l_email" placeholder="Email"><br>
    <input id="l_password" type="password" placeholder="Password"><br>
    <button onclick="login()">Login</button>
  </div>

  <!-- Admin Login -->
  <div class="section">
    <h2>Admin Login</h2>
    <input id="a_email" placeholder="Admin Email"><br>
    <input id="a_password" type="password" placeholder="Admin Password"><br>
    <button onclick="adminLogin()">Login</button>
  </div>

  <script>
    const API_BASE = "https://life-predictor.onrender.com";

    async function register() {
      let res = await fetch(`${API_BASE}/register/?name=${r_name.value}&email=${r_email.value}&password=${r_password.value}`, {method:"POST"});
      let data = await res.json();
      alert(data.message || JSON.stringify(data));
    }

    async function login() {
      let res = await fetch(`${API_BASE}/login/?email=${l_email.value}&password=${l_password.value}`, {method:"POST"});
      let data = await res.json();
      if (data.user_id) {
        localStorage.setItem("user_id", data.user_id);
        window.location.href = "index.html"; // redirect to prediction page
      } else {
        alert("Login failed");
      }
    }

    async function adminLogin() {
      let res = await fetch(`${API_BASE}/admin-login/?email=${a_email.value}&password=${a_password.value}`, {method:"POST"});
      let data = await res.json();
      if (data.is_admin) {
        let subs = await fetch(`${API_BASE}/admin/submissions/`);
        let all = await subs.json();
        alert("All Submissions:\n" + JSON.stringify(all, null, 2));
      } else {
        alert("Admin login failed");
      }
    }
  </script>
</body>
</html>
